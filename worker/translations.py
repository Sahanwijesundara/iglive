# worker/translations.py
# Multi-language support for IGLiveZBot

TRANSLATIONS = {
    'en': {
        'welcome': '🎉 *Welcome to IGLiveZBot!*',
        'welcome_back': 'Welcome back! 👋',
        'starter_bonus': '🎁 *Starter Bonus:* +10 Points',
        'referral_bonus': '🔗 *Referral Bonus:* Applied',
        'good_morning': '🌅 *Good Morning!*',
        'daily_reset': 'Your daily points have been refreshed!',
        'daily_bonus': '💎 *Daily Bonus:* +10 Points',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Track Instagram Live Streams*',
        'track_ig_desc': 'See who\'s live in real-time',
        'smart_points': '💎 *Smart Points System*',
        'smart_points_desc': 'Get 10 free points daily',
        'refer_earn': '🎁 *Refer & Earn*',
        'refer_earn_desc': '10 bonus points per referral',
        'choose_option': 'Choose an option below to continue:',
        'check_live': '🔴 Check Live',
        'my_account': '👤 My Account',
        'referrals': '🎁 Referrals',
        'help': 'ℹ️ Help',
        'back_to_menu': '⬅️ Back to Menu',
    },
    'ru': {
        'welcome': '🎉 *Добро пожаловать в IGLiveZBot!*',
        'welcome_back': 'С возвращением! 👋',
        'starter_bonus': '🎁 *Стартовый бонус:* +10 очков',
        'referral_bonus': '🔗 *Реферальный бонус:* Применён',
        'good_morning': '🌅 *Доброе утро!*',
        'daily_reset': 'Ваши ежедневные очки обновлены!',
        'daily_bonus': '💎 *Ежедневный бонус:* +10 очков',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Отслеживайте Instagram Live*',
        'track_ig_desc': 'Смотрите кто в эфире в режиме реального времени',
        'smart_points': '💎 *Умная система очков*',
        'smart_points_desc': 'Получайте 10 бесплатных очков ежедневно',
        'refer_earn': '🎁 *Приглашайте и зарабатывайте*',
        'refer_earn_desc': '10 бонусных очков за реферала',
        'choose_option': 'Выберите опцию ниже:',
        'check_live': '🔴 Проверить трансляции',
        'my_account': '👤 Мой аккаунт',
        'referrals': '🎁 Рефералы',
        'help': 'ℹ️ Помощь',
        'back_to_menu': '⬅️ Назад в меню',
    },
    'es': {
        'welcome': '🎉 *¡Bienvenido a IGLiveZBot!*',
        'welcome_back': '¡Bienvenido de nuevo! 👋',
        'starter_bonus': '🎁 *Bono inicial:* +10 Puntos',
        'referral_bonus': '🔗 *Bono por referido:* Aplicado',
        'good_morning': '🌅 *¡Buenos días!*',
        'daily_reset': '¡Tus puntos diarios se han actualizado!',
        'daily_bonus': '💎 *Bono diario:* +10 Puntos',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Rastrea Lives de Instagram*',
        'track_ig_desc': 'Ve quién está en vivo en tiempo real',
        'smart_points': '💎 *Sistema inteligente de puntos*',
        'smart_points_desc': 'Obtén 10 puntos gratis diarios',
        'refer_earn': '🎁 *Refiere y gana*',
        'refer_earn_desc': '10 puntos extra por referido',
        'choose_option': 'Elige una opción a continuación:',
        'check_live': '🔴 Ver en vivo',
        'my_account': '👤 Mi cuenta',
        'referrals': '🎁 Referidos',
        'help': 'ℹ️ Ayuda',
        'back_to_menu': '⬅️ Volver al menú',
    },
    'pt': {
        'welcome': '🎉 *Bem-vindo ao IGLiveZBot!*',
        'welcome_back': 'Bem-vindo de volta! 👋',
        'starter_bonus': '🎁 *Bônus inicial:* +10 Pontos',
        'referral_bonus': '🔗 *Bônus de indicação:* Aplicado',
        'good_morning': '🌅 *Bom dia!*',
        'daily_reset': 'Seus pontos diários foram atualizados!',
        'daily_bonus': '💎 *Bônus diário:* +10 Pontos',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Rastreie Lives do Instagram*',
        'track_ig_desc': 'Veja quem está ao vivo em tempo real',
        'smart_points': '💎 *Sistema inteligente de pontos*',
        'smart_points_desc': 'Ganhe 10 pontos grátis diariamente',
        'refer_earn': '🎁 *Indique e ganhe*',
        'refer_earn_desc': '10 pontos extras por indicação',
        'choose_option': 'Escolha uma opção abaixo:',
        'check_live': '🔴 Ver ao vivo',
        'my_account': '👤 Minha conta',
        'referrals': '🎁 Indicações',
        'help': 'ℹ️ Ajuda',
        'back_to_menu': '⬅️ Voltar ao menu',
    },
    'ar': {
        'welcome': '🎉 *مرحباً بك في IGLiveZBot!*',
        'welcome_back': 'مرحباً بعودتك! 👋',
        'starter_bonus': '🎁 *مكافأة البداية:* +10 نقاط',
        'referral_bonus': '🔗 *مكافأة الإحالة:* مطبقة',
        'good_morning': '🌅 *صباح الخير!*',
        'daily_reset': 'تم تحديث نقاطك اليومية!',
        'daily_bonus': '💎 *المكافأة اليومية:* +10 نقاط',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *تتبع البث المباشر على Instagram*',
        'track_ig_desc': 'شاهد من يبث مباشرة الآن',
        'smart_points': '💎 *نظام النقاط الذكي*',
        'smart_points_desc': 'احصل على 10 نقاط مجانية يومياً',
        'refer_earn': '🎁 *قم بالإحالة واكسب*',
        'refer_earn_desc': '10 نقاط إضافية لكل إحالة',
        'choose_option': 'اختر خياراً أدناه:',
        'check_live': '🔴 تحقق من البث المباشر',
        'my_account': '👤 حسابي',
        'referrals': '🎁 الإحالات',
        'help': 'ℹ️ المساعدة',
        'back_to_menu': '⬅️ العودة للقائمة',
    },
    'it': {
        'welcome': '🎉 *Benvenuto in IGLiveZBot!*',
        'welcome_back': 'Bentornato! 👋',
        'starter_bonus': '🎁 *Bonus iniziale:* +10 Punti',
        'referral_bonus': '🔗 *Bonus referral:* Applicato',
        'good_morning': '🌅 *Buongiorno!*',
        'daily_reset': 'I tuoi punti giornalieri sono stati aggiornati!',
        'daily_bonus': '💎 *Bonus giornaliero:* +10 Punti',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Traccia Live di Instagram*',
        'track_ig_desc': 'Vedi chi è in diretta in tempo reale',
        'smart_points': '💎 *Sistema punti intelligente*',
        'smart_points_desc': 'Ottieni 10 punti gratis al giorno',
        'refer_earn': '🎁 *Invita e guadagna*',
        'refer_earn_desc': '10 punti bonus per referral',
        'choose_option': 'Scegli un\'opzione qui sotto:',
        'check_live': '🔴 Verifica Live',
        'my_account': '👤 Il mio account',
        'referrals': '🎁 Referral',
        'help': 'ℹ️ Aiuto',
        'back_to_menu': '⬅️ Torna al menu',
    },
    'fr': {
        'welcome': '🎉 *Bienvenue sur IGLiveZBot!*',
        'welcome_back': 'Bon retour! 👋',
        'starter_bonus': '🎁 *Bonus de départ:* +10 Points',
        'referral_bonus': '🔗 *Bonus de parrainage:* Appliqué',
        'good_morning': '🌅 *Bonjour!*',
        'daily_reset': 'Vos points quotidiens ont été actualisés!',
        'daily_bonus': '💎 *Bonus quotidien:* +10 Points',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Suivez les Lives Instagram*',
        'track_ig_desc': 'Voyez qui est en direct en temps réel',
        'smart_points': '💎 *Système de points intelligent*',
        'smart_points_desc': 'Obtenez 10 points gratuits par jour',
        'refer_earn': '🎁 *Parrainez et gagnez*',
        'refer_earn_desc': '10 points bonus par parrainage',
        'choose_option': 'Choisissez une option ci-dessous:',
        'check_live': '🔴 Vérifier les Lives',
        'my_account': '👤 Mon compte',
        'referrals': '🎁 Parrainages',
        'help': 'ℹ️ Aide',
        'back_to_menu': '⬅️ Retour au menu',
    },
    'de': {
        'welcome': '🎉 *Willkommen bei IGLiveZBot!*',
        'welcome_back': 'Willkommen zurück! 👋',
        'starter_bonus': '🎁 *Startbonus:* +10 Punkte',
        'referral_bonus': '🔗 *Empfehlungsbonus:* Angewendet',
        'good_morning': '🌅 *Guten Morgen!*',
        'daily_reset': 'Deine täglichen Punkte wurden aktualisiert!',
        'daily_bonus': '💎 *Täglicher Bonus:* +10 Punkte',
        'bot_title': '⭐️ *IGLiveZBot* ⭐️',
        'track_ig_live': '🔴 *Verfolge Instagram Lives*',
        'track_ig_desc': 'Sieh in Echtzeit, wer live ist',
        'smart_points': '💎 *Intelligentes Punktesystem*',
        'smart_points_desc': 'Erhalte täglich 10 kostenlose Punkte',
        'refer_earn': '🎁 *Empfehle und verdiene*',
        'refer_earn_desc': '10 Bonuspunkte pro Empfehlung',
        'choose_option': 'Wähle unten eine Option:',
        'check_live': '🔴 Live prüfen',
        'my_account': '👤 Mein Konto',
        'referrals': '🎁 Empfehlungen',
        'help': 'ℹ️ Hilfe',
        'back_to_menu': '⬅️ Zurück zum Menü',
    },
}

# Language names for selection menu
LANGUAGE_NAMES = {
    'en': '🇬🇧 English',
    'ru': '🇷🇺 Русский',
    'es': '🇪🇸 Español',
    'pt': '🇵🇹 Português',
    'ar': '🇸🇦 العربية',
    'it': '🇮🇹 Italiano',
    'fr': '🇫🇷 Français',
    'de': '🇩🇪 Deutsch',
}

# Map Telegram language codes to our supported languages
TELEGRAM_LANG_MAP = {
    'en': 'en',
    'ru': 'ru',
    'es': 'es',
    'pt': 'pt',
    'ar': 'ar',
    'it': 'it',
    'fr': 'fr',
    'de': 'de',
    # Fallback for similar languages
    'pt-br': 'pt',
    'pt-pt': 'pt',
    'es-mx': 'es',
    'es-es': 'es',
    'ar-sa': 'ar',
    'ar-ae': 'ar',
}


def get_text(key: str, lang: str = 'en', **kwargs) -> str:
    """
    Get translated text for a given key and language.
    
    Args:
        key: Translation key
        lang: Language code (defaults to 'en')
        **kwargs: Format parameters for string formatting
        
    Returns:
        Translated string, falls back to English if not found
    """
    # Fallback to English if language not supported
    if lang not in TRANSLATIONS:
        lang = 'en'
    
    # Get translation, fallback to English if key not found
    text = TRANSLATIONS.get(lang, {}).get(key, TRANSLATIONS['en'].get(key, key))
    
    # Apply formatting if parameters provided
    if kwargs:
        try:
            text = text.format(**kwargs)
        except (KeyError, ValueError):
            pass  # Return unformatted if parameters don't match
    
    return text


def detect_language(telegram_language_code: str) -> str:
    """
    Detect user's preferred language from Telegram language code.
    
    Args:
        telegram_language_code: Language code from Telegram user object
        
    Returns:
        Supported language code, defaults to 'en'
    """
    if not telegram_language_code:
        return 'en'
    
    # Normalize to lowercase
    lang_code = telegram_language_code.lower()
    
    # Try exact match
    if lang_code in TELEGRAM_LANG_MAP:
        return TELEGRAM_LANG_MAP[lang_code]
    
    # Try language prefix (e.g., 'en-US' -> 'en')
    lang_prefix = lang_code.split('-')[0] if '-' in lang_code else lang_code
    if lang_prefix in TELEGRAM_LANG_MAP:
        return TELEGRAM_LANG_MAP[lang_prefix]
    
    # Default to English
    return 'en'
